<!-- 
 ******************************************************************************
 * Copyright (c) 2012 Oracle and Liferay
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Konstantin Komissarchik - initial implementation and ongoing maintenance
 *    Gregory Amerson - [372359] Provide means to extend the behavior of adapt methods
 ******************************************************************************
-->

<html>

<head>
  <title>Enhancements in Sapphire 0.5</title>
  <link rel="StyleSheet" href="../../style.css" TYPE="text/css"/>
</head>

<body>
<h1>Enhancements in 0.5</h1>
<ol>
  <li><a href="#UI">User Interface</a></li>
  <ol type="A">
    <li><a href="#MoreFlexibleActuatorPresentation">More Flexible Actuator Presentation</a></li>
  </ol>
  <li><a href="#DiagramLayout">Diagram Layout Storage</li>
  <li><a href="#Services">Services</a></li>
  <ol type="A">
    <li><a href="#AdapterService">AdapterService</a></li>
  </ol>
</ol>


<h2><a name="UI"><a name="MoreFlexibleActuatorPresentation">More Flexible Actuator Presentation</a></a></h2>

<p>An actuator provides means to invoke an action. The action could be drawn from the context where actuator 
is placed or provided as part of actuator's definition. Actuators were formerly limited to links and were
referred to as action links. New for this release is the ability to choose either link or button presentation
along with ability to control horizontal alignment.</p>

<p style="margin-left: 20px;"><b>Example</b></p>

<pre class="source-code"><code><font color="#888888">&lt;actuator>
    &lt;action-id>Sapphire.Gallery.Actuators.DoubleTheNumber&lt;/action-id>
    &lt;action>
        &lt;id>Sapphire.Gallery.Actuators.DoubleTheNumber&lt;/id>
        &lt;label>double the number&lt;/label>
    &lt;/action>
    &lt;action-handler>
        &lt;id>Sapphire.Gallery.Actuators.DoubleTheNumber&lt;/id>
        &lt;action>Sapphire.Gallery.Actuators.DoubleTheNumber&lt;/action>
        &lt;impl>ActuatorsGalleryDoubleTheNumberActionHandler&lt;/impl>
    &lt;/action-handler></font>
    &lt;span>false&lt;/span>
    &lt;horizontal-align>right&lt;/horizontal-align>
    &lt;style>Sapphire.Actuator.Button&lt;/style>
<font color="#888888">&lt;/actuator></font></code></pre>

<p style="margin-left: 20px;"><img src="images/MoreFlexibleActuatorPresentation.png"/></p>

<h2><a name="DiagramLayout">More Flexible Diagram Layout Storage</a></h2>

<p>Diagram Editor can now open workspace files, non-workspace files and non-local files. Developer can
choose to store diagram's layout information in a separate file in the same folder as the file being
edited, or a computed unique folder in project's .setting directory for workspace files. For non-workspace
files, the layout file will be stored in a folder under the current workspace's .metadata directory.</p>

<p>The diagram layout storage location is controlled by diagram page definition's "SideBySideLayoutStorage" property.</p>


<h2><a name="Services"><a name="AdapterService">AdapterService</a></a></h2>

<p>The AdapterService provides means to extend the behavior of the adapt method in a given context.</p>

<p>For example, out of the box, Sapphire can adapt IModelElement to IProject assuming that the model is using
an IFile for the underlying resource store.  However, in some cases there may be no underlying IFile, so the
default logic will no be able to find IProject. To solve this problem, we can introduce an adapter service to 
provide a custom method for adopting IModelElement to IProject.</p>

<p style="margin-left: 20px;"><b>Example</b></p>

<pre class="source-code"><code><font color="#888888">@GenerateImpl</font>
@Service( impl = NewProjectFileOpAdapter.class )

<font color="#888888">public interface INewProjectFileOp extends IModelElement
{
    ...
}</font></code></pre>

<pre class="source-code"><code>public class NewProjectFileOpAdapter extends AdapterService
{
    @Override
    public &lt;A&gt; A adapt( Class&lt;A&gt; adapterType )
    {
        if( IProject.class == adapterType )
        {
            INewProjectFileOp op = context( INewProjectFileOp.class );
            IProject project = op.getProject().resolve();

            if( project != null )
            {
                return adapterType.cast( project );
            }
        }

        return null;
    }
}</code></pre>


<div class="copyright">Copyright (c) 2012 Oracle and Liferay<br/>
Content made available under the terms of <a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License</a>.</div>


</body>

</html>