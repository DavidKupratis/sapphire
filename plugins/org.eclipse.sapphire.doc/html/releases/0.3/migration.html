<html>

<head>
  <title>Migration Guide for Sapphire 0.3</title>
  <link rel="StyleSheet" href="../../style.css" TYPE="text/css"/>
  <style type="text/css">
    pre.source-code 
    {
      font-family: Andale Mono, Lucida Console, Monaco, fixed, monospace; 
      color: #000000;
      background-color: #ffffff;
      font-size: 12px;
      border: 0px;
      line-height: 14px;
      padding: 5px;
      margin-left: 0px;
      margin-right: 0px;
      overflow: auto
    }
</style></head>

<body>

<h1>Migration Guide for 0.3</h1>

<p>This documents covers code changes that need to be made by Sapphire adopters as part of migrating 
to 0.3 release. Only changes from the previous milestone are covered.</p>

<p>Table of Contents</p>

<ol>
  <li><a href="#html">HTML Content Presentation</a></li>
  <li><a href="#related-content">Related Content</a></li>
  <li><a href="#composite-ref">Composite Reference</a></li>
  <li><a href="#section-description">Section Description</a></li>
</ol>

<h2><a name="html">HTML Content Presentation</a></h2>

<p>Support for presenting HTML content in Sapphire UI was introduced in the 0.2 release in
the form of @HtmlContent annotation and a read-only property editor. This approach proved
to be too inflexible and has been replaced with a dedicated HTML UI part that can display
HTML content that's statically specified, drawn from the model or even fetched remotely.</p>

<table>
  <tr>
    <th>Before</th>
    <th>After</th>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code>@HtmlContent</code></pre>
    </td>
    <td>
<pre class="source-code"><code><i>remove</i></code></pre>
    </td>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code>&lt;property-editor>
  &lt;property>MessageBody&lt;/property>
  &lt;hint>
    &lt;name>show.label&lt;/name>
    &lt;value>false&lt;/value>
  &lt;/hint>
&lt;/property-editor></code></pre>
    </td>
    <td>
<pre class="source-code"><code>&lt;html>
  &lt;content>${ MessageBody }&lt;/content>
  &lt;show-border/>
&lt;/html></code></pre>
    </td>
  </tr>
</table>

<p><a href="index.html#html">See New Feature Documentation</a></p>

<h2><a name="related-content">Related Content</a></h2>

<p>The ability to augment a property editor with an auxiliary property editor has been generalized
into a more powerful related content feature.</p>

<table>
  <tr>
    <th>Before</th>
    <th>After</th>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code><font color="#888888">&lt;property-editor>
  &lt;property>MainProperty&lt;/property></font>
  &lt;aux-property-editor>RelatedProperty&lt;/aux-property-editor>
<font color="#888888">&lt;/property-editor></font></code></pre>
    </td>
    <td>
<pre class="source-code"><code><font color="#888888">&lt;property-editor>
  &lt;property>MainProperty&lt;/property></font>
  &lt;related-content>
    &lt;property-editor>RelatedProperty&lt;/property-editor>
  &lt;/related-content>
<font color="#888888">&lt;/property-editor></font></code></pre>
    </td>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code><font color="#888888">&lt;property-editor>
  &lt;property>MainProperty&lt;/property></font>
  &lt;aux-property-editor>RelatedProperty1&lt;/aux-property-editor>
  &lt;aux-property-editor>RelatedProperty2&lt;/aux-property-editor>
<font color="#888888">&lt;/property-editor></font></code></pre>
    </td>
    <td>
<pre class="source-code"><code><font color="#888888">&lt;property-editor>
  &lt;property>MainProperty&lt;/property></font>
  &lt;related-content>
    &lt;property-editor>
      &lt;property>RelatedProperty1&lt;/property>
      &lt;related-content>
        &lt;property>RelatedProperty2&lt;/property>
      &lt;/related-content>
    &lt;/property-editor>
  &lt;/related-content>
<font color="#888888">&lt;/property-editor></font></code></pre>
    </td>
  </tr>
</table>

<p><a href="index.html#related-content">See New Feature Documentation</a></p>

<h2><a name="composite-ref">Composite Reference</a></h2>

<p>The composite-ref construct has been replaced with a more flexible include construct which allows
any form part to be included.</p>

<table>
  <tr>
    <th>Before</th>
    <th>After</th>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code>&lt;composite-ref>
  &lt;id>bug.report&lt;/id>
&lt;/composite-ref></code></pre>
    </td>
    <td>
<pre class="source-code"><code>&lt;include>bug.report&lt;/include></code></pre>
    </td>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code>&lt;composite-ref>
  &lt;id>bug.report&lt;/id>
  &lt;param>
    &lt;name>SomeParam&lt;/name>
    &lt;value>SomeValue&lt;/value>
  &lt;/param>
&lt;/composite-ref></code></pre>
    </td>
    <td>
<pre class="source-code"><code>&lt;include>
  &lt;part>bug.report&lt;/part>
  &lt;param>
    &lt;name>SomeParam&lt;/name>
    &lt;value>SomeValue&lt;/value>
  &lt;/param>
&lt;/include></code></pre>
    </td>
  </tr>
</table>

<p>The following Eclipse search/replace regular expressions can be used to perform this
migration (only works when there are no params):</p>

<p style="margin-left: 20px;"><code>Scope: &nbsp;&nbsp;&nbsp;*.sdef<br/>
<nobr>Search: &nbsp;&nbsp;(?s)&lt;composite-ref>.*?&lt;id>(.*?)&lt;/id>.*?&lt;/composite-ref></nobr><br/>
<nobr>Replace: &nbsp;&lt;include>\1&lt;/include></nobr></p>

<h2><a name="section-description">Section Description</a></h2>

<p>The description construct under section has been removed. Use label and spacer to achieve the same result.</p>

<table>
  <tr>
    <th>Before</th>
    <th>After</th>
  </tr>
  <tr>
    <td>
<pre class="source-code"><code>&lt;section>
  &lt;description>description&lt;/description></id>
&lt;/section></code></pre>
    </td>
    <td>
<pre class="source-code"><code>&lt;section>
  &lt;content>
    &lt;label>description&lt;/label>
    &lt;spacer/>
  &lt;/content>
&lt;/section></code></pre>
    </td>
  </tr>
</table>

<br/><br/>

</body>

</html>